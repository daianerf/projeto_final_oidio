{"title":"Análise de dados do PowderyMildew:","markdown":{"yaml":{"title":"Análise de dados do PowderyMildew:"},"headingText":"Introdução","containsRefs":false,"markdown":"\n\n\nO banco de dados analisado neste trabalho refere-se aos resultados de um experimento conduzido com o objetivo de avaliar o desenvolvimento do oídio (*Leveillula taurica*) na cultura do tomateiro sob diferentes condições de irrigação e umidade do solo. \n\nForam avaliadas cinco estratégias de irrigação combinadas com dois níveis de umidade do solo (alta e moderada), totalizando diferentes condições experimentais, embora o delineamento não tenha sido fatorial completo. O experimento incluiu o monitoramento da severidade da doença ao longo do tempo (0, 7, 14, 21, 28, 35, 42, 49, 56 e 63). A partir desses dados, buscou-se compreender de que forma o ambiente de cultivo, especialmente as práticas de irrigação podem influenciar a severidade do oídio.\n\n# Objetivo geral\n\nPor meio da análise dos dados, objetivou-se avaliar a influência de diferentes sistemas de irrigação e níveis de umidade do solo sobre a severidade do oídio (*Leveillula taurica*) em tomateiro cultivado em sistema orgânico, considerando o progresso da doença ao longo do tempo.\n\n## Objetivos específicos\n\n-   Analisar a dinâmica da severidade do oídio em diferentes combinações de irrigação e umidade do solo, ao longo do tempo;\n\n-   Identificar quais estratégias de irrigação contribuem para a redução da severidade da doença;\n\n-   Verificar a interação entre tipo de irrigação e nível de umidade na progressão do oídio.\n\n# **Hipóteses testadas**\n\n**Hipótese nula (H₀):\\\n**Não há diferença significativa na severidade da doença entre os diferentes tipos de irrigação e níveis de umidade do solo. A média da severidade é igual em todos os tratamentos avaliados.\n\n**Hipótese alternativa (Hₐ):\\\n**Pelo menos uma das combinações de tipo de irrigação e nível de umidade apresenta severidade significativamente diferente das demais, indicando efeito do tratamento sobre o desenvolvimento da doença.\n\n## Análise da variável resposta (Severidade do oídio)\n\n### Carregamento automático de pacotes\n\nA primeira etapa para a análise dos dados é a instalação e o carregamento dos pacotes e dados no ambiente R.\n\n```{r, warning=FALSE, message=FALSE}\n# Instalar e carregar pacotes\n#Verificação e instalação automática de pacotes necessários\npackages <- c(\"readxl\", \"dplyr\", \"ggplot2\", \"epifitter\", \"agricolae\", \"car\", \"gganimate\", \"animate\", \"DHARMa\", \"ggthemes\", \"skimr\", \"DataExplorer\", \"tidyverse\", \"gifski\", \"showtext\", \"sysfonts\",\"png\", \"easystats\", \"performance\", \"emmeans\", \"multcomp\")\nnew_packages <- packages[!(packages %in% installed.packages()[, \"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n\n# Carregar os pacotes\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(epifitter)\nlibrary(agricolae)\nlibrary(car)  # para Levene\nlibrary(gganimate)\nlibrary(animate)\nlibrary(DHARMa)\nlibrary(skimr)\nlibrary(DataExplorer)\nlibrary(ggthemes)\nlibrary(tidyverse)\nlibrary(gifski)\nlibrary(showtext) #Para utilizar outras fontes\nlibrary(sysfonts) #Para utilizar outras fontes\nlibrary(png)\nlibrary(easystats)\nlibrary(performance)\nlibrary(emmeans)\nlibrary(multcomp)\n```\n\n### Importação dos dados\n\nComo o data frame contendo os dados de severidade estão localizados em uma planilha do Excel, para realizar a importação dos dados necessitou-se utilizar a função `read_excel( )` do pacote `readxl`. O data frame foi atribuído ao objeto denominado dados.\n\n```{r}\ndados <- read_excel(\"dados.xlsx\")\n\ndados\n```\n\n### Verificação do conjunto de dados\n\nPara realizar uma inspeção inicial dos dados, foram utilizadas três funções principais no R: `glimpse()`, `skim()` e `names()`.\n\nA função glimpse mostra do pacote `dplyr`, permite uma visão geral compacta do conjunto de dados. Ela exibe:\n\n1.  O número de linhas e colunas;\n\n2.  O tipo de dado de cada variável (por exemplo, numérico, caracterer);\n\n3.  Os primeiros valores presentes em cada coluna;\n\nA função `skim()`, do pacote `skimr` fornece um resumo estatístico mais detalhado. Inclui média, mediana, mínimo, máximo, número de valores ausentes (NA).\n\nA função `names()` foi empregada para listar os nomes reais das colunas do dataframe, permitindo identificar com clareza as variáveis disponíveis para análise.\n\n```{r}\nglimpse(dados)\n\nskim(dados)\n\nnames(dados)\n```\n\n## Estabelecendo o visual do trabalho\n\n#### Estabelecendo fontes\n\nPara aprimorar a estética visual de gráficos e aplicações no R, foram adicionadas fontes do Google Fonts utilizando a função `font_add_google()` da biblioteca **`showtext`**. Cada chamada da função carrega uma fonte específica, associando-a a um nome de família que pode ser usado posteriormente em elementos gráficos, como títulos, eixos e textos.\n\nAs fontes adicionadas foram: **Montserrat, Inter, Manrope, Nunito, Work Sans, Lexend, Raleway, Quicksand, Roboto e Poppins.\\\n**Após a adição das fontes, a função `showtext_auto()` foi ativada. Essa função garante que as fontes personalizadas sejam corretamente renderizadas em gráficos gerados com o R, inclusive ao exportar para imagens.\n\n```{r}\nfont_add_google(name = \"inter\", family = \"inter\")\nfont_add_google(name = \"manrope\", family = \"manrope\")\nfont_add_google(name = \"nunito\", family = \"nunito\")\nfont_add_google(name = \"work sans\", family = \"work sans\")\nfont_add_google(name = \"lexend\", family = \"lexend\")\nfont_add_google(name = \"raleway\", family = \"raleway\")\nfont_add_google(name = \"quicksand\", family = \"quicksand\")\nfont_add_google(name = \"roboto\", family = \"roboto\")\nfont_add_google(name = \"poppins\", family = \"poppins\")\nshowtext_auto()\n```\n\n#### Estabelecendo cores\n\nO vetor *cores_irrigation* define um conjunto de cores associadas a diferentes métodos de irrigação, permitindo a padronização visual em gráficos.\n\nCada tipo de irrigação é representado por uma cor específica, facilitando a visualização dos dados:\n\n-   Drip: representado pela cor azul ecuro (#000194);\n\n-   Furrow: verde vibrante (#28C800);\n\n-   MS: vermelho intenso (#C90A00);\n\n-   MS above canopy: laranja (#E68A2E);\n\n-   Overhead: amarelo brilhante (#FFDE00);\n\n```{r}\ncores_irrigation <- c(\n  \"Drip\" = \"#000194\",\n  \"Furrow\" = \"#28C800\",\n  \"MS\" = \"#C90A00\",\n  \"MS above canopy\" = \"#E68A2E\",\n  \"Overhead\" = \"#FFDE00\"\n)\n\ncores_contorno <- c(\n  \"Drip\" = \"#000060\",\n  \"Furrow\" = \"#1E9E00\",\n  \"MS\" = \"#990700\",\n  \"MS above canopy\" = \"#A6601F\",\n  \"Overhead\" = \"#CCA800\"\n)\n```\n\n### Análise exploratória dos dados\n\nNa etapa inicial da análise exploratória, foi utilizada a função `plot_missing()` do pacote `DataExplorer`, que gera um gráfico de barras indicando a porcentagem de dados faltantes (valores NA) por variável no conjunto de dados. Essa visualização permite identificar rapidamente colunas com problemas de completude, facilitando decisões sobre limpeza ou imputação de dados. O gráfico gerado foi personalizado com o título \"Dados Faltantes\", e o tema visual foi ajustado com `theme_hc()` para melhor apresentação.\n\n```{r}\nplot_missing(dados)\n```\n\nA função `summary()` é uma ferramenta prática para explorar rapidamente os dados. É usada para gerar um resumo estatístico básico de um data frame. Fornece medidas como mínimo, máximo, média, mediana e quartis para variáveis numéricas, e a frequência para variáveis categóricas.\n\n```{r}\nsummary(dados)\n```\n\n### Organização dos dados\n\nAo examinar os dados, observou-se que os tratamentos (irrigation_type: Drip, MS, Furrow, MS Above canopy, Overhead) não estão igualmente distribuídos entre as duas condições de umidade (moisture: high e moderate). Dessa forma para a análise visual dos dados resolveu-se dividi-los de acordo com seus níveis de umidade.\n\n```{r}\n# Subconjunto para irrigação com umidade moderada\ndados_moderate <- dados %>% filter(moisture == \"Moderate moisture\")\n\n# Subconjunto para irrigação com umidade alta\ndados_high <- dados %>% filter(moisture == \"High moisture\")\n\ndados_moderate\n\ndados_high\n```\n\n### Análise visual\n\nUsando o pacote `ggplot2`, foi explorado visualmente, por meio de diferentes gráficos, os dados de severidade da doença.\n\n#### Gráficos de pontos\n\nNesta análise, foram desenvolvidos dois gráficos de dispersão. Esses gráficos de pontos fornecem uma visão clara da distribuição da severidade da doença ao longo do tempo, permitindo comparar como os diferentes tipos de irrigação influenciam os resultados sob distintas condições de umidade.\n\n##### Gráfico de Severidade ao Longo do Tempo – Umidade Moderada\n\nPara o conjunto dados_moderate, foi utilizado o tempo (time) no eixo X e a severidade da doença (sev) no eixo Y. A variável **irrigation_type** foi representada por diferentes cores, facilitando a comparação entre os tratamentos. A função `geom_jitter()` foi empregada para aplicar uma leve dispersão horizontal aos pontos. As cores dos tratamentos foram definidas manualmente com `scale_color_manual()` e a estética do gráfico foi finalizada com `theme_minimal()`.\n\n```{r}\n# Gráficos de pontos (dados de umidade moderada)\nggplot(dados_moderate, aes(x = time, y = sev, color = irrigation_type)) +\n  geom_jitter(size = 2, alpha = 0.7) +\n  labs(\n    title = \"Severidade ao longo do tempo - Umidade Moderada\",\n    x = \"Tempo\",\n    y = \"Severidade\",\n    color = \"Tipo de Irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  theme_minimal() +  # base limpa\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n     plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  )\n```\n\n##### **Gráfico de Severidade ao Longo do Tempo – Umidade Alta**\n\nPara a condição de **umidade alta**, foi construído um gráfico semelhante, utilizando o conjunto dados_high.\n\n```{r}\n# Gráficos de pontos (dados de umidade alta)\nggplot(dados_high, aes(x = time, y = sev, color = irrigation_type)) +\n  geom_jitter(size = 2, alpha = 0.7) +\n  labs(\n    title = \"Severidade ao longo do tempo - Umidade Alta\",\n    x = \"Tempo\",\n    y = \"Severidade\",\n    color = \"Tipo de Irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  theme_minimal() +  # base limpa\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n     plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  )\n```\n\n#### Gráfico de pontos e linhas\n\nAntes da construção do gráfico, os dados foram agrupados pelas variáveis tratamento (combinação de tipo de irrigação + umidade), e time (tempo de avaliação). Em seguida, foi calculada a média da severidade (sev_mean) e o desvio padrão (sev_sd) para cada grupo. Ambas as métricas foram multiplicadas por 100 para expressar os valores em percentual:\n\nO gráfico foi gerado com base no objeto dados3, contendo os valores médios e as respectivas variações da severidade. Os principais elementos visuais são: **Linhas `(geom_line)`**: mostram a evolução média da severidade ao longo do tempo para cada tratamento. **Pontos `(geom_point)`**: indicam os valores médios pontuais, com o preenchimento colorido conforme o tratamento. **Barras de erro `(geom_errorbar)`**: representam a variação (± desvio padrão) em torno da média, permitindo avaliar a dispersão dos dados.\n\n##### Preparação e agregação dos dados\n\nUtilizou-se a função `mutate()` para criar uma nova variável chamada \"tratamento\", que combina os fatores tipo de irrigação (*irrigation_type*) e nível de umidade do solo (*moisture*) em uma única coluna, separadas por \" + \".\n\nAlém disso, a variável *irrigation_type* foi convertida para fator, permitindo seu uso na definição das cores dos gráficos.\n\nEm seguida, os dados foram agregados com `group_by()`. Com `summarise()`, foram calculadas: A média da severidade da doença (`sev_mean`), expressa em porcentagem. O desvio padrão da severidade (`sev_sd`), também em porcentagem.\n\nEsses valores foram reunidos em um novo conjunto de dados (*dados3*) que serviu de base para a construção de gráficos de tendência com barras de erro, permitindo a visualização da evolução da severidade da doença ao longo do tempo, com comparação entre os diferentes tratamentos.\n\n```{r}\n#ALTERAÇÃO DE DADOS\ndados2 <- dados %>%\n  mutate(\n    tratamento = paste(irrigation_type, moisture, sep = \" + \"),  # >>> coluna usada no eixo x\n    irrigation_type = as.factor(irrigation_type)  # >>> usada para definir as cores\n  )\n\ndados3 <- dados2 %>% \n  group_by(tratamento, irrigation_type, moisture, time) %>%\n  summarise(\n    sev_mean = mean(sev, na.rm = TRUE) * 100,\n    sev_sd = sd(sev, na.rm = TRUE) * 100\n  )\n```\n\n##### Gráfico de pontos e linhas para severidade moderada\n\n```{r}\n# Gráfico para Moderate moisture\nggplot(\n  dados3 %>% filter(moisture == \"Moderate moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), size = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +\n  geom_errorbar(aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n                width = 0, alpha = 1) +\n  theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_text(family = \"roboto\", size = 11),  # alterado para mostrar texto ao invés de blank\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Severidade da doença - Umidade Moderada\",\n    x = \"Tempo (dias)\",\n    y = \"Disease severity (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation)\n```\n\n##### Gráfico de pontos e linhas para severidade alta\n\n```{r}\n# Gráfico para high moisture\nggplot(\n  dados3 %>% filter(moisture == \"High moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), size = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +  # fill é mapeado, contorno preto fixo\n  geom_errorbar(aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n                width = 0, alpha = 1) +\n theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_text(family = \"roboto\", size = 11),  # alterado para mostrar texto ao invés de blank\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  )+\n  labs(\n    title = \"Severidade da doença - Alta Umidade\",\n    x = \"Tempo (dias)\",\n    y = \"Disease severity (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation)\n```\n\n#### Gráfico de pontos e linhas animado\n\nForam criadas animações para ilustrar a evolução da severidade da doença ao longo do tempo sob condição específicas de solo, considerando os diferentes tipos de irrigação avaliados no experimento.\n\nPara isso, os dados foram filtrados de forma a incluir apenas as observações com umidade classificada como \"moderate moisture\" em um gráfico e \"high moisture\" no outro. Em seguida, utilizou-se o pacote `ggplot2` para construir o gráfico.\n\nA animação foi gerada com a função `animate()` do pacote gganimate, com taxa de 10 quadros por segundo, resolução de 800x500 pixels e salvo como arquivo .gif nomeado \"severidade\\_\\[moisture_level\\]\\_moisture.gif\".\n\nEssa visualização dinâmica permite observar de forma clara como a severidade da doença evolui ao longo do tempo sob diferentes tipos de irrigação.\n\n##### Umidade moderada\n\n```{r}\n\ngif_moderate <- ggplot(\n  dados3 %>% filter(moisture == \"Moderate moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), linewidth = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +\n  geom_errorbar(\n    aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n    width = 0.2, alpha = 0.8\n  ) +\n  theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    axis.title = element_text(family = \"roboto\", size = 12),\n    axis.text = element_text(family = \"roboto\", size = 11),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Umidade Moderada — Dia: {frame_along}\",\n    x = \"Tempo (dias)\",\n    y = \"Severidade da doença (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation) +\n  transition_reveal(along = time)\n\n#gif_anim_moderate <- animate(gif_moderate, fps = 10, width = 800, height = 500, renderer = #gifski_renderer())\n#anim_save(\"severidade_moderate_moisture.gif\", gif_anim_moderate)\n```\n\n![](severidade_moderate_moisture.gif)\n\n##### Umidade alta\n\n```{r}\ngif_high <- ggplot(\n  dados3 %>% filter(moisture == \"High moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), linewidth = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +\n  geom_errorbar(\n    aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n    width = 0.2, alpha = 0.8\n  ) +\n  theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    axis.title = element_text(family = \"roboto\", size = 12),\n    axis.text = element_text(family = \"roboto\", size = 11),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Alta Umidade — Dia: {frame_along}\",\n    x = \"Tempo (dias)\",\n    y = \"Severidade da doença (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation) +\n  transition_reveal(along = time)\n\n#Criar animação\n#gif_anim_high <- animate(gif_high, fps = 10, width = 800, height = 500, renderer = #gifski_renderer())\n\n# Salvar\n#anim_save(\"severidade_high_moisture.gif\", gif_anim_high)\n```\n\n![](severidade_high_moisture.gif)\n\n###### Observações:\n\nNeste estudo, foram avaliados cinco tipos de irrigação sob dois níveis de umidade do solo: High (alta) e Moderate (moderada). No entanto, o experimento não segue um delineamento fatorial completo, ou seja, nem todos os tipos de irrigação possuem dados para ambos os níveis de umidade.\n\nMais especificamente:\n\n-   O sistema de irrigação Drip possui dados apenas sob condição de alta umidade (High), não havendo registros para umidade moderada;\n\n-   Por outro lado, o sistema Furrow está representado apenas sob umidade moderada (Moderate), sem dados disponíveis para alta umidade.\n\nDevido a essas lacunas no delineamento, optamos por remover as combinações incompletas. Como consequência, os tratamentos \"Drip\" (alta umidade) e \"Furrow\" (umidade moderada) foram excluídos da análise, uma vez que não permitem a comparação entre os dois níveis de umidade. Essa decisão teve como objetivo garantir uma análise da interação entre os métodos de irrigação sob diferentes condições de umidade.\n\n```{r}\n# Identificar quais irrigation_type têm os dois níveis de moisture\ntipos_validos <- dados %>%\n  group_by(irrigation_type) %>%\n  summarise(n_moisture = n_distinct(moisture)) %>%\n  filter(n_moisture == 2) %>%\n  pull(irrigation_type)\n\n# Filtrar os dados para manter apenas os tipos válidos\ndados_filtrados <- dados %>%\n  filter(irrigation_type %in% tipos_validos)\n```\n\n#### Boxplot de severidade final\n\n```{r}\ndados_63 <- dados_filtrados |> \n  dplyr::filter(time == 63)\n\naov_dados63 = aov(sev ~ irrigation_type*moisture + as.factor(block), data = dados_63)\nsummary(aov_dados63)\n```\n\n```{r}\n\nggplot(dados_63, aes(x = irrigation_type, y = sev, fill = irrigation_type, color = irrigation_type)) +\n  geom_boxplot(alpha = 0.8, size = 0.8, show.legend = FALSE) +\n  labs(\n    title = \"Severidade por Tipo de Irrigação e Umidade\",\n    x = NULL,  # >>> remove o título do eixo X\n    y = \"Severidade\",\n    fill = \"Tipo de Irrigação\",  # >>> legenda mais limpa\n    color = \"Tipo de Irrigação\"\n  ) +\n  geom_jitter(shape = 1, size = 1) +\n  scale_fill_manual(values = cores_irrigation) +  # >>> novas cores por tipo\n  scale_color_manual(values = cores_contorno) +      # >>> novos contornos por tipo\n  facet_wrap(~moisture) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_blank(),  # >>> inclinação para visualização melhor\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),  # >>> aumento da fonte para melhor leitura\n    legend.position = \"bottom\"\n  ) +\nguides(\n  fill = guide_legend(override.aes = list(shape = 21, size = 5))\n)\n```\n\n## Análise estatística e teste de hipóteses\n\n-   **Hipótese nula (H₀):** A severidade da doença é igual para todos os tratamentos estudados;\n\n-   **Hipótese alternativa (Hₐ):** Pelo menos um dos tratamentos apresenta severidade média diferente da dos demais.\n\n### ANOVA\n\nPara a realização da ANOVA, foi considerado apenas o último tempo de avaliação da severidade da doença (aos 63 dias de avaliação), uma vez que o objetivo principal era identificar quais tratamentos apresentaram menor severidade e, portanto, foram mais eficazes no controle da doença. A análise foi conduzida para avaliar os efeitos do tipo de irrigação (*irrigation_type*), do nível de umidade do solo (*moisture*) e de sua interação (*irrigation_type × moisture*). O bloco experimental (*block*) foi incluído como fator aleatório, convertido com `as.factor(block)`.\n\nA análise do modelo de ANOVA foi realizada utilizando a função `aov`, a qual faz parte do pacote base do R. Os resultados da ANOVA foram obtidos com s`ummary(aov_dados63)`, permitindo a identificação de efeitos significativos entre os tratamentos.\n\n| Efeito | df | F value | Pr(\\>F) | Significância |\n|----|----|----|----|----|\n| `irrigation_type` | 2 | 462.898 | 1.39e-10 | \\*\\*\\* significativo ao nível de 0% |\n| `moisture` | 1 | 13.342 | 0.00444 | \\*\\* significativo ao nível de 0,1% |\n| `block` (como fator) | 2 | 0.221 | 0.80572 | NS |\n| `irrigation_type:moisture` | 2 | 3.661 | 0.06413 | . significativo ao nível de 5% |\n| `residual` | 10 | — | — | — |\n\nA hipótese nula (H₀) foi rejeitada, uma vez que os valores de *p* para os fatores principais foram menores que ao nível de significância de 0,05. Assim, aceita-se a hipótese alternativa (Hₐ), indicando que pelo menos um dos tratamentos difere significativamente dos demais.\n\n-   Efeito principal de tipo de irrigação (*irrigation_type*):\\\n    Muito significativo (p \\< 0,001), indicando que os diferentes métodos de irrigação afetaram de forma clara e consistente a severidade da doença;\n\n-   Efeito principal de umidade (*moisture*):\\\n    Significativo (p = 0,00444), sugerindo que o nível de umidade do solo (alta vs. moderada) também teve impacto importante na severidade da doença, independentemente do tipo de irrigação;\n\n-   Efeito do bloco (*block*):\\\n    Não significativo (p = 0,80572), indicando que a variação entre blocos foi mínima, o que pode ser interpretado como consistência entre repetições;\n\n-   Interação entre irrigação e umidade (*irrigation_type:moisture*): Marginalmente significativa (p = 0,06413), a interação entre os fatores sugere que o efeito da umidade pode depender do tipo de irrigação. Embora não tenha atingido significância estatística ao nível de 5%, o valor de p indica uma tendência de interação que poderia se tornar significativa com um maior número de repetições ou uma amostra mais robusta, reduzindo a variabilidade e aumentando o poder do teste.\n\n#### Checagem das premissas\n\n##### Histograma\n\nPara verificar a normalidade dos resíduos do modelo de ANOVA, foi construído um histograma dos resíduos utilizando a função `hist()`. O comando `residuals(aov_dados63)` extrai os resíduos do modelo.\n\n```{r}\n# Histogram\nhist(residuals(aov_dados63),\n     main = \"Histograma dos resíduos da ANOVA (SEV)\",\n     xlab = \"Resíduos\",\n     ylab = \"Frequência\",\n     col = \"lightgreen\",\n     border = \"black\")\n```\n\n###### Interpretação\n\nForma aproximadamente simétrica: a distribuição dos resíduos é centrada em torno de zero, o que é um indicativo positivo de normalidade. Os resíduos estão distribuídos em um intervalo relativamente estreito (aproximadamente entre -0,025 e 0,02), sugerindo ausência de valores extremos (*outliers*). A maior frequência de resíduos ocorre próxima de zero, o que é característico de distribuições normais.\n\n##### DHARMa\n\nPara avaliar as suposições do modelo linear ajustado, foi utilizada a simulação de resíduos por meio do pacote `DHARMa`.\n\nPrimeiramente, foi ajustado um modelo linear aos dados. Em seguida, os resíduos foram simulados com a função `simulateResiduals()` do pacote `DHARMa`, que gera resíduos padronizados baseados em simulações sob o modelo ajustado. Essa abordagem é especialmente útil para detectar desvios de normalidade, heterocedasticidade e efeitos de estrutura nos dados.\n\n###### Painel esquerdo - QQ-plot dos resíduos simulados:\n\nEsse gráfico demonstra a normalidade dos resíduos de forma robusta.\n\nOs triângulos seguem bem a linha vermelha de 45°, o que é um bom sinal.\n\n**KS test:** p = 0.69937, maior que p \\> 0.05. Não há evidência de que os resíduos violam a normalidade.\n\n**Dispersion test:** p = 0.24. Não há problema de superdispersão.\n\n**Outlier test:** p = 1. Nenhum outlier significativo detectado.\n\nOs resíduos estão aproximadamente normais e sem outliers problemáticos. Pressuposto de normalidade atendido.\n\n###### **Painel Direito - Resíduos simulados vs valores preditos**\n\nO que o gráfico indica:\n\nRed curves = significância estatística: a presença de curvas vermelhas indica que houve desvio significativo dos quantis esperados.\n\nO texto vermelho confirma: Isso não é um problema grave, mas sugere que:\n\nPode haver algum padrão residual leve, talvez relacionado a variâncias diferentes entre grupos (heterocedasticidade leve).\n\nIsso não invalida o modelo, mas é um sinal para cautela na interpretação dos efeitos.\n\nPor isso, foi realizado o leveneTest() para confirmar se há heterocedasticidade.\n\nDepois foram  utilizados testes mais específicos para verificar a normalidade:\n\n```{r}\nmodelo_lm <- lm(sev ~ irrigation_type * moisture + as.factor(block), data = dados_63)\n\n# 4. Simular resíduos com DHARMa\nresiduos_sim <- simulateResiduals(fittedModel = modelo_lm)\n\n# 5. Plotar diagnósticos\nplot(residuos_sim)\n```\n\n###### Normalidade\n\nPrimeiramente, utilizou-se a função `check_normality()` para obter uma verificação geral da normalidade dos resíduos.\n\nEm seguida, foi construído um gráfico QQ-plot (Quantile-Quantile). Esse gráfico compara a distribuição dos resíduos observados com a distribuição normal teórica. Uma boa aderência dos pontos à linha vermelha indica que os resíduos seguem aproximadamente uma distribuição normal, o que foi observado no gráfico, sem desvios acentuados.\n\nPor fim, foi aplicado o teste de *Shapiro-Wilk* `shapiro.test()`. Esse teste estatístico avalia formalmente a hipótese nula de que os resíduos seguem uma distribuição normal. Um valor de *p* ≥ que 0,05 indica que não há evidências para rejeitar a normalidade dos resíduos, confirmando que essa suposição foi atendida no modelo.\n\n```{r}\ncheck_normality(aov_dados63)\n\n# QQ-plot\nqqnorm(residuals(aov_dados63), main = \"QQ-Plot dos resíduos\") \nqqline(residuals(aov_dados63), col = \"red\", lwd = 2)\n\n# Teste de Shapiro-Wilk\nshapiro.test(residuals(aov_dados63))\n```\n\n###### Homocedasticidade\n\nTeste geral com check_heteroscedasticity().\n\n#### **Testes estatísticos:**\n\n**Bartlett’s test (**`bartlett.test`**):** É indicado apenas quando os resíduos seguem uma distribuição normal. \n\nUm valor de *p* \\> 0,05 indica que não há evidência significativa de heterogeneidade de variâncias, ou seja, a suposição de homocedasticidade é atendida.**\\\n**\n\n**Levene’s test (**`leveneTest`**):** Este teste é mais robusto quando a normalidade não pode ser totalmente garantida.\\\nUm *p* \\> 0,05 sugere homogeneidade de variâncias entre os grupos. Se o valor for menor que 0,05, isso indicaria heterocedasticidade, violando uma das suposições da ANOVA.\n\n```{r}\ncheck_heteroscedasticity(aov_dados63)\n\n#Bartlett (apenas se resíduos forem normais):\nbartlett.test(sev ~ interaction(irrigation_type, moisture), data = dados_63)\n\n#Para dados não necessariamente normais\nleveneTest(sev ~ interaction(irrigation_type, moisture), data = dados_63)\n\n```\n\n### Teste de comparação de médias\n\n```{r}\n# Médias ajustadas\nmedias <- emmeans(modelo_lm, ~ irrigation_type * moisture)\n\n# Comparações de médias com agrupamento por letras\nletras <- cld(medias, adjust = \"sidak\", Letters = letters)\n\n# Visualizar resultado\nprint(letras)\n```\n\nA tabela abaixo apresenta as médias ajustadas da severidade da doença para cada combinação de tipo de irrigação e umidade, incluindo erro padrão, intervalos de confiança, e o agrupamento por letras. O agrupamento foi feito com base na comparação múltipla utilizando o método de Sidak ajustado para Tukey (α = 0,05). Letras iguais indicam ausência de diferença estatística significativa.\n\n|  |  |  |  |  |  |  |  |\n|----|----|----|----|----|----|----|----|\n| Tipo de Irrigação | Umidade | Média Ajustada | SE | GL | IC Inferior | IC Superior | Grupo |\n| Overhead | Alta | 0.124 | 0.00898 | 10 | 0.0944 | 0.153 | a |\n| Overhead | Moderada | 0.129 | 0.00898 | 10 | 0.1 | 0.159 | a |\n| MS above canopy | Alta | 0.147 | 0.00898 | 10 | 0.1174 | 0.176 | a |\n| MS above canopy | Moderada | 0.168 | 0.00898 | 10 | 0.1387 | 0.197 | a |\n| MS | Alta | 0.35 | 0.00898 | 10 | 0.321 | 0.38 | b |\n| MS | Moderada | 0.404 | 0.00898 | 10 | 0.3744 | 0.433 | c |\n\n```{r}\nemmeans(modelo_lm, pairwise ~ moisture, adjust = \"tukey\")\ncld(emmeans(modelo_lm, ~ moisture), adjust = \"tukey\")\n\n```\n\nA tabela abaixo apresenta as médias ajustadas da severidade da doença para cada nível de umidade, com erro padrão, intervalos de confiança e agrupamento por letras. O agrupamento foi realizado utilizando o método de Sidak (α = 0,05), ajustado a partir de comparações múltiplas.\n\n|          |                |         |     |             |             |       |\n|----------|----------------|---------|-----|-------------|-------------|-------|\n| Umidade  | Média Ajustada | SE      | GL  | IC Inferior | IC Superior | Grupo |\n| Alta     | 0.207          | 0.00518 | 10  | 0.193       | 0.221       | 1     |\n| Moderada | 0.234          | 0.00518 | 10  | 0.22        | 0.247       | 2     |\n\n## AUDPC\n\nPara quantificar o avanço da doença ao longo do tempo, foi realizada a análise da Área Abaixo da Curva de Progresso da Doença (*AACPD* ou *AUDPC*), utilizando todos os tempos de avaliação disponíveis no experimento. Essa métrica resume, em um único valor, a intensidade acumulada da doença durante o período observado, sendo amplamente utilizada em estudos epidemiológicos por refletir tanto a severidade quanto a duração da infecção.\n\nA análise foi conduzida com o pacote `epifitter` (fornece funções para análise do cálculo da AACPD), especificamente por meio da função `audpc()`. A função `audpc()` calcula a Área Abaixo da Curva de Progresso da Doença com base: na severidade da doença *(sev)* multiplicada por 100 (para expressar em %), e no tempo de avaliação *(time)*. O resultado é armazenado em *aacpd_resultado*, que contém uma linha para cada combinação de tratamento e bloco, com o valor correspondente da AACPD.\n\n```{r}\nlibrary(epifitter)\nlibrary(dplyr)\n\n# 3. Calcular a AACPD para cada combinação de tratamento e bloco\naacpd_resultado <- dados2 %>%\n  group_by(tratamento, block) %>%\n  summarise(AACPD = audpc(sev*100, time), .groups = \"drop\")\n\n# 4. Visualizar os resultados\nprint(aacpd_resultado)\n\n```\n\n### ANOVA\n\n```{r}\nmodelo_aacpd <- aov(AACPD ~ tratamento, data = aacpd_resultado)\nsummary(modelo_aacpd)\n```\n\n#### Checagem das premissas\n\n##### Histograma\n\nO gráfico mostrou uma distribuição aproximadamente simétrica e centrada em torno de zero, o que indica que os resíduos seguem uma tendência próxima à distribuição normal.\n\n```{r}\n# Histogram\nhist(residuals(modelo_aacpd),\n     main = \"Histograma dos resíduos da ANOVA (AACPD)\",\n     xlab = \"Resíduos\",\n     ylab = \"Frequência\",\n     col = \"lightgreen\",\n     border = \"black\")\n```\n\n##### DHARMa (AACPD)\n\nOs resultados indicaram que o modelo se comporta adequadamente, sem violações evidentes dos pressupostos estatísticos. Entretanto o resultado apresentado pelo teste de resíduos simulados *vs* valores preditos exige com o que seja necessário fazer testes adicionais.\n\n```{r}\nmodelo_lmaacpd <- lm(AACPD ~ tratamento + as.factor(block), data = aacpd_resultado)\n\n# 4. Simular resíduos com DHARMa\nresiduos_simaacpd <- simulateResiduals(fittedModel = modelo_lmaacpd)\n\n# 5. Plotar diagnósticos\nplot(residuos_simaacpd)\n```\n\n###### Normalidade (AACPD)\n\nA normalidade dos resíduos do modelo de ANOVA para a variável *AACPD* foi avaliada por meio do gráfico QQ-Plot e do teste de Shapiro-Wilk. O gráfico indicou boa aderência dos resíduos à linha de normalidade. Já o teste de Shapiro-Wilk apresentou valor de *p* = 0,3125, indicando que não há evidência significativa de violação da normalidade (*p* \\> 0,05). Portanto, o modelo atende ao pressuposto de normalidade dos resíduos, sendo apropriado para a análise.\n\n```{r}\ncheck_normality(modelo_aacpd)\n\n# QQ-plot\nqqnorm(residuals(modelo_aacpd), main = \"QQ-Plot dos resíduos\")\nqqline(residuals(modelo_aacpd), col = \"red\", lwd = 2)\n\n# Teste de Shapiro-Wilk\nshapiro.test(residuals(modelo_aacpd))\n```\n\n###### Homocedasticidade (AACPD)\n\nEsses dados confirmam a homocedasticidade dos dados, confirmando portanto a última premissa da ANOVA.\n\n```{r}\ncheck_heteroscedasticity(modelo_aacpd)\n\n#Bartlett (apenas se resíduos forem normais):\nbartlett.test(AACPD ~ tratamento, data = aacpd_resultado)\n\n#Para dados não necessariamente normais\nleveneTest(AACPD ~ tratamento, data = aacpd_resultado)\n\n```\n\n### Boxplot (AACPD)\n\n```{r}\naacpd_resultado2 <- aacpd_resultado %>%\n  mutate(\n    irrigation_type = case_when(\n      str_detect(tratamento, \"Drip\") ~ \"Drip\",\n      str_detect(tratamento, \"Furrow\") ~ \"Furrow\",\n      str_detect(tratamento, \"MS above canopy\") ~ \"MS above canopy\",\n      str_detect(tratamento, \"MS\") ~ \"MS\",\n      str_detect(tratamento, \"Overhead\") ~ \"Overhead\"\n    )\n  )\n\naacpd_resultado2 <- aacpd_resultado2 %>%\n  mutate(\n    irrigation_type = case_when(\n      str_detect(tratamento, \"Drip\") ~ \"Drip\",\n      str_detect(tratamento, \"Furrow\") ~ \"Furrow\",\n      str_detect(tratamento, \"MS above canopy\") ~ \"MS above canopy\",\n      str_detect(tratamento, \"MS\") ~ \"MS\",\n      str_detect(tratamento, \"Overhead\") ~ \"Overhead\"\n    ),\n    moisture = case_when(\n      str_detect(tratamento, \"High moisture\") ~ \"High moisture\",\n      str_detect(tratamento, \"Moderate moisture\") ~ \"Moderate moisture\",\n      str_detect(tratamento, \"Low moisture\") ~ \"Low moisture\"\n    )\n  )\n\n\nggplot(aacpd_resultado2, aes(x = tratamento, y = AACPD, fill = irrigation_type, color = irrigation_type)) +\n  geom_boxplot(alpha = 0.8, size = 0.8, show.legend = FALSE) +\n  labs(\n    title = \"Área Abaixo da Curva do Progresso da Doença (AACPD)\",\n    x = NULL,\n    y = \"AACPD\",\n    fill = \"Tipo de Irrigação\",\n    color = \"Tipo de Irrigação\"\n  ) +\n  geom_jitter(shape = 1, size = 1) +\n  scale_fill_manual(values = cores_irrigation) +\n  scale_color_manual(values = cores_contorno) +\n  facet_wrap(~moisture) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_blank(),\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  guides(\n    fill = guide_legend(override.aes = list(shape = 21, size = 5))\n  )\n```\n\n### Teste de comparação de médias (AACPD)\n\n```{r}\n# ANOVA já ajustada no objeto modelo_aacpd\n# Teste de comparação de médias (Tukey)\n# Converter bloco para fator, se necessário\naacpd_resultado$block <- as.factor(aacpd_resultado$block)\n\n# Rodar ANOVA novamente com bloco (modelo mais completo)\nmodelo_com_bloco <- aov(AACPD ~ tratamento + block, data = aacpd_resultado)\n\n# Teste de Tukey com agricolae\ntukey_resultado <- HSD.test(modelo_com_bloco, trt = \"tratamento\", group = TRUE)\n\n# Visualizar grupos\nprint(tukey_resultado$groups)\n\n```\n\nA tabela abaixo apresenta as médias de AACPD e o agrupamento por letras. O agrupamento foi feito com base na comparação múltipla utilizando o método de TukeyHSD ajustado para Tukey (α = 0,05). Letras iguais indicam ausência de diferença estatística significativa.\n\n| Tratamento                              | Média AACPD | Grupo |\n|-----------------------------------------|-------------|-------|\n| **Furrow + Moderate moisture**          | 1379.93     | a     |\n| **Drip + High moisture**                | 1338.98     | a     |\n| **MS + Moderate moisture**              | 1118.37     | b     |\n| **MS + High moisture**                  | 852.02      | c     |\n| **MS above canopy + Moderate moisture** | 485.57      | d     |\n| **MS above canopy + High moisture**     | 399.23      | de    |\n| **Overhead + Moderate moisture**        | 381.27      | e     |\n| **Overhead + High moisture**            | 368.43      | e     |\n","srcMarkdownNoYaml":"\n\n# Introdução\n\nO banco de dados analisado neste trabalho refere-se aos resultados de um experimento conduzido com o objetivo de avaliar o desenvolvimento do oídio (*Leveillula taurica*) na cultura do tomateiro sob diferentes condições de irrigação e umidade do solo. \n\nForam avaliadas cinco estratégias de irrigação combinadas com dois níveis de umidade do solo (alta e moderada), totalizando diferentes condições experimentais, embora o delineamento não tenha sido fatorial completo. O experimento incluiu o monitoramento da severidade da doença ao longo do tempo (0, 7, 14, 21, 28, 35, 42, 49, 56 e 63). A partir desses dados, buscou-se compreender de que forma o ambiente de cultivo, especialmente as práticas de irrigação podem influenciar a severidade do oídio.\n\n# Objetivo geral\n\nPor meio da análise dos dados, objetivou-se avaliar a influência de diferentes sistemas de irrigação e níveis de umidade do solo sobre a severidade do oídio (*Leveillula taurica*) em tomateiro cultivado em sistema orgânico, considerando o progresso da doença ao longo do tempo.\n\n## Objetivos específicos\n\n-   Analisar a dinâmica da severidade do oídio em diferentes combinações de irrigação e umidade do solo, ao longo do tempo;\n\n-   Identificar quais estratégias de irrigação contribuem para a redução da severidade da doença;\n\n-   Verificar a interação entre tipo de irrigação e nível de umidade na progressão do oídio.\n\n# **Hipóteses testadas**\n\n**Hipótese nula (H₀):\\\n**Não há diferença significativa na severidade da doença entre os diferentes tipos de irrigação e níveis de umidade do solo. A média da severidade é igual em todos os tratamentos avaliados.\n\n**Hipótese alternativa (Hₐ):\\\n**Pelo menos uma das combinações de tipo de irrigação e nível de umidade apresenta severidade significativamente diferente das demais, indicando efeito do tratamento sobre o desenvolvimento da doença.\n\n## Análise da variável resposta (Severidade do oídio)\n\n### Carregamento automático de pacotes\n\nA primeira etapa para a análise dos dados é a instalação e o carregamento dos pacotes e dados no ambiente R.\n\n```{r, warning=FALSE, message=FALSE}\n# Instalar e carregar pacotes\n#Verificação e instalação automática de pacotes necessários\npackages <- c(\"readxl\", \"dplyr\", \"ggplot2\", \"epifitter\", \"agricolae\", \"car\", \"gganimate\", \"animate\", \"DHARMa\", \"ggthemes\", \"skimr\", \"DataExplorer\", \"tidyverse\", \"gifski\", \"showtext\", \"sysfonts\",\"png\", \"easystats\", \"performance\", \"emmeans\", \"multcomp\")\nnew_packages <- packages[!(packages %in% installed.packages()[, \"Package\"])]\nif(length(new_packages)) install.packages(new_packages)\n\n\n# Carregar os pacotes\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(epifitter)\nlibrary(agricolae)\nlibrary(car)  # para Levene\nlibrary(gganimate)\nlibrary(animate)\nlibrary(DHARMa)\nlibrary(skimr)\nlibrary(DataExplorer)\nlibrary(ggthemes)\nlibrary(tidyverse)\nlibrary(gifski)\nlibrary(showtext) #Para utilizar outras fontes\nlibrary(sysfonts) #Para utilizar outras fontes\nlibrary(png)\nlibrary(easystats)\nlibrary(performance)\nlibrary(emmeans)\nlibrary(multcomp)\n```\n\n### Importação dos dados\n\nComo o data frame contendo os dados de severidade estão localizados em uma planilha do Excel, para realizar a importação dos dados necessitou-se utilizar a função `read_excel( )` do pacote `readxl`. O data frame foi atribuído ao objeto denominado dados.\n\n```{r}\ndados <- read_excel(\"dados.xlsx\")\n\ndados\n```\n\n### Verificação do conjunto de dados\n\nPara realizar uma inspeção inicial dos dados, foram utilizadas três funções principais no R: `glimpse()`, `skim()` e `names()`.\n\nA função glimpse mostra do pacote `dplyr`, permite uma visão geral compacta do conjunto de dados. Ela exibe:\n\n1.  O número de linhas e colunas;\n\n2.  O tipo de dado de cada variável (por exemplo, numérico, caracterer);\n\n3.  Os primeiros valores presentes em cada coluna;\n\nA função `skim()`, do pacote `skimr` fornece um resumo estatístico mais detalhado. Inclui média, mediana, mínimo, máximo, número de valores ausentes (NA).\n\nA função `names()` foi empregada para listar os nomes reais das colunas do dataframe, permitindo identificar com clareza as variáveis disponíveis para análise.\n\n```{r}\nglimpse(dados)\n\nskim(dados)\n\nnames(dados)\n```\n\n## Estabelecendo o visual do trabalho\n\n#### Estabelecendo fontes\n\nPara aprimorar a estética visual de gráficos e aplicações no R, foram adicionadas fontes do Google Fonts utilizando a função `font_add_google()` da biblioteca **`showtext`**. Cada chamada da função carrega uma fonte específica, associando-a a um nome de família que pode ser usado posteriormente em elementos gráficos, como títulos, eixos e textos.\n\nAs fontes adicionadas foram: **Montserrat, Inter, Manrope, Nunito, Work Sans, Lexend, Raleway, Quicksand, Roboto e Poppins.\\\n**Após a adição das fontes, a função `showtext_auto()` foi ativada. Essa função garante que as fontes personalizadas sejam corretamente renderizadas em gráficos gerados com o R, inclusive ao exportar para imagens.\n\n```{r}\nfont_add_google(name = \"inter\", family = \"inter\")\nfont_add_google(name = \"manrope\", family = \"manrope\")\nfont_add_google(name = \"nunito\", family = \"nunito\")\nfont_add_google(name = \"work sans\", family = \"work sans\")\nfont_add_google(name = \"lexend\", family = \"lexend\")\nfont_add_google(name = \"raleway\", family = \"raleway\")\nfont_add_google(name = \"quicksand\", family = \"quicksand\")\nfont_add_google(name = \"roboto\", family = \"roboto\")\nfont_add_google(name = \"poppins\", family = \"poppins\")\nshowtext_auto()\n```\n\n#### Estabelecendo cores\n\nO vetor *cores_irrigation* define um conjunto de cores associadas a diferentes métodos de irrigação, permitindo a padronização visual em gráficos.\n\nCada tipo de irrigação é representado por uma cor específica, facilitando a visualização dos dados:\n\n-   Drip: representado pela cor azul ecuro (#000194);\n\n-   Furrow: verde vibrante (#28C800);\n\n-   MS: vermelho intenso (#C90A00);\n\n-   MS above canopy: laranja (#E68A2E);\n\n-   Overhead: amarelo brilhante (#FFDE00);\n\n```{r}\ncores_irrigation <- c(\n  \"Drip\" = \"#000194\",\n  \"Furrow\" = \"#28C800\",\n  \"MS\" = \"#C90A00\",\n  \"MS above canopy\" = \"#E68A2E\",\n  \"Overhead\" = \"#FFDE00\"\n)\n\ncores_contorno <- c(\n  \"Drip\" = \"#000060\",\n  \"Furrow\" = \"#1E9E00\",\n  \"MS\" = \"#990700\",\n  \"MS above canopy\" = \"#A6601F\",\n  \"Overhead\" = \"#CCA800\"\n)\n```\n\n### Análise exploratória dos dados\n\nNa etapa inicial da análise exploratória, foi utilizada a função `plot_missing()` do pacote `DataExplorer`, que gera um gráfico de barras indicando a porcentagem de dados faltantes (valores NA) por variável no conjunto de dados. Essa visualização permite identificar rapidamente colunas com problemas de completude, facilitando decisões sobre limpeza ou imputação de dados. O gráfico gerado foi personalizado com o título \"Dados Faltantes\", e o tema visual foi ajustado com `theme_hc()` para melhor apresentação.\n\n```{r}\nplot_missing(dados)\n```\n\nA função `summary()` é uma ferramenta prática para explorar rapidamente os dados. É usada para gerar um resumo estatístico básico de um data frame. Fornece medidas como mínimo, máximo, média, mediana e quartis para variáveis numéricas, e a frequência para variáveis categóricas.\n\n```{r}\nsummary(dados)\n```\n\n### Organização dos dados\n\nAo examinar os dados, observou-se que os tratamentos (irrigation_type: Drip, MS, Furrow, MS Above canopy, Overhead) não estão igualmente distribuídos entre as duas condições de umidade (moisture: high e moderate). Dessa forma para a análise visual dos dados resolveu-se dividi-los de acordo com seus níveis de umidade.\n\n```{r}\n# Subconjunto para irrigação com umidade moderada\ndados_moderate <- dados %>% filter(moisture == \"Moderate moisture\")\n\n# Subconjunto para irrigação com umidade alta\ndados_high <- dados %>% filter(moisture == \"High moisture\")\n\ndados_moderate\n\ndados_high\n```\n\n### Análise visual\n\nUsando o pacote `ggplot2`, foi explorado visualmente, por meio de diferentes gráficos, os dados de severidade da doença.\n\n#### Gráficos de pontos\n\nNesta análise, foram desenvolvidos dois gráficos de dispersão. Esses gráficos de pontos fornecem uma visão clara da distribuição da severidade da doença ao longo do tempo, permitindo comparar como os diferentes tipos de irrigação influenciam os resultados sob distintas condições de umidade.\n\n##### Gráfico de Severidade ao Longo do Tempo – Umidade Moderada\n\nPara o conjunto dados_moderate, foi utilizado o tempo (time) no eixo X e a severidade da doença (sev) no eixo Y. A variável **irrigation_type** foi representada por diferentes cores, facilitando a comparação entre os tratamentos. A função `geom_jitter()` foi empregada para aplicar uma leve dispersão horizontal aos pontos. As cores dos tratamentos foram definidas manualmente com `scale_color_manual()` e a estética do gráfico foi finalizada com `theme_minimal()`.\n\n```{r}\n# Gráficos de pontos (dados de umidade moderada)\nggplot(dados_moderate, aes(x = time, y = sev, color = irrigation_type)) +\n  geom_jitter(size = 2, alpha = 0.7) +\n  labs(\n    title = \"Severidade ao longo do tempo - Umidade Moderada\",\n    x = \"Tempo\",\n    y = \"Severidade\",\n    color = \"Tipo de Irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  theme_minimal() +  # base limpa\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n     plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  )\n```\n\n##### **Gráfico de Severidade ao Longo do Tempo – Umidade Alta**\n\nPara a condição de **umidade alta**, foi construído um gráfico semelhante, utilizando o conjunto dados_high.\n\n```{r}\n# Gráficos de pontos (dados de umidade alta)\nggplot(dados_high, aes(x = time, y = sev, color = irrigation_type)) +\n  geom_jitter(size = 2, alpha = 0.7) +\n  labs(\n    title = \"Severidade ao longo do tempo - Umidade Alta\",\n    x = \"Tempo\",\n    y = \"Severidade\",\n    color = \"Tipo de Irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  theme_minimal() +  # base limpa\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n     plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  )\n```\n\n#### Gráfico de pontos e linhas\n\nAntes da construção do gráfico, os dados foram agrupados pelas variáveis tratamento (combinação de tipo de irrigação + umidade), e time (tempo de avaliação). Em seguida, foi calculada a média da severidade (sev_mean) e o desvio padrão (sev_sd) para cada grupo. Ambas as métricas foram multiplicadas por 100 para expressar os valores em percentual:\n\nO gráfico foi gerado com base no objeto dados3, contendo os valores médios e as respectivas variações da severidade. Os principais elementos visuais são: **Linhas `(geom_line)`**: mostram a evolução média da severidade ao longo do tempo para cada tratamento. **Pontos `(geom_point)`**: indicam os valores médios pontuais, com o preenchimento colorido conforme o tratamento. **Barras de erro `(geom_errorbar)`**: representam a variação (± desvio padrão) em torno da média, permitindo avaliar a dispersão dos dados.\n\n##### Preparação e agregação dos dados\n\nUtilizou-se a função `mutate()` para criar uma nova variável chamada \"tratamento\", que combina os fatores tipo de irrigação (*irrigation_type*) e nível de umidade do solo (*moisture*) em uma única coluna, separadas por \" + \".\n\nAlém disso, a variável *irrigation_type* foi convertida para fator, permitindo seu uso na definição das cores dos gráficos.\n\nEm seguida, os dados foram agregados com `group_by()`. Com `summarise()`, foram calculadas: A média da severidade da doença (`sev_mean`), expressa em porcentagem. O desvio padrão da severidade (`sev_sd`), também em porcentagem.\n\nEsses valores foram reunidos em um novo conjunto de dados (*dados3*) que serviu de base para a construção de gráficos de tendência com barras de erro, permitindo a visualização da evolução da severidade da doença ao longo do tempo, com comparação entre os diferentes tratamentos.\n\n```{r}\n#ALTERAÇÃO DE DADOS\ndados2 <- dados %>%\n  mutate(\n    tratamento = paste(irrigation_type, moisture, sep = \" + \"),  # >>> coluna usada no eixo x\n    irrigation_type = as.factor(irrigation_type)  # >>> usada para definir as cores\n  )\n\ndados3 <- dados2 %>% \n  group_by(tratamento, irrigation_type, moisture, time) %>%\n  summarise(\n    sev_mean = mean(sev, na.rm = TRUE) * 100,\n    sev_sd = sd(sev, na.rm = TRUE) * 100\n  )\n```\n\n##### Gráfico de pontos e linhas para severidade moderada\n\n```{r}\n# Gráfico para Moderate moisture\nggplot(\n  dados3 %>% filter(moisture == \"Moderate moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), size = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +\n  geom_errorbar(aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n                width = 0, alpha = 1) +\n  theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_text(family = \"roboto\", size = 11),  # alterado para mostrar texto ao invés de blank\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Severidade da doença - Umidade Moderada\",\n    x = \"Tempo (dias)\",\n    y = \"Disease severity (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation)\n```\n\n##### Gráfico de pontos e linhas para severidade alta\n\n```{r}\n# Gráfico para high moisture\nggplot(\n  dados3 %>% filter(moisture == \"High moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), size = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +  # fill é mapeado, contorno preto fixo\n  geom_errorbar(aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n                width = 0, alpha = 1) +\n theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_text(family = \"roboto\", size = 11),  # alterado para mostrar texto ao invés de blank\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  )+\n  labs(\n    title = \"Severidade da doença - Alta Umidade\",\n    x = \"Tempo (dias)\",\n    y = \"Disease severity (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation)\n```\n\n#### Gráfico de pontos e linhas animado\n\nForam criadas animações para ilustrar a evolução da severidade da doença ao longo do tempo sob condição específicas de solo, considerando os diferentes tipos de irrigação avaliados no experimento.\n\nPara isso, os dados foram filtrados de forma a incluir apenas as observações com umidade classificada como \"moderate moisture\" em um gráfico e \"high moisture\" no outro. Em seguida, utilizou-se o pacote `ggplot2` para construir o gráfico.\n\nA animação foi gerada com a função `animate()` do pacote gganimate, com taxa de 10 quadros por segundo, resolução de 800x500 pixels e salvo como arquivo .gif nomeado \"severidade\\_\\[moisture_level\\]\\_moisture.gif\".\n\nEssa visualização dinâmica permite observar de forma clara como a severidade da doença evolui ao longo do tempo sob diferentes tipos de irrigação.\n\n##### Umidade moderada\n\n```{r}\n\ngif_moderate <- ggplot(\n  dados3 %>% filter(moisture == \"Moderate moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), linewidth = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +\n  geom_errorbar(\n    aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n    width = 0.2, alpha = 0.8\n  ) +\n  theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    axis.title = element_text(family = \"roboto\", size = 12),\n    axis.text = element_text(family = \"roboto\", size = 11),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Umidade Moderada — Dia: {frame_along}\",\n    x = \"Tempo (dias)\",\n    y = \"Severidade da doença (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation) +\n  transition_reveal(along = time)\n\n#gif_anim_moderate <- animate(gif_moderate, fps = 10, width = 800, height = 500, renderer = #gifski_renderer())\n#anim_save(\"severidade_moderate_moisture.gif\", gif_anim_moderate)\n```\n\n![](severidade_moderate_moisture.gif)\n\n##### Umidade alta\n\n```{r}\ngif_high <- ggplot(\n  dados3 %>% filter(moisture == \"High moisture\"),\n  aes(x = time, y = sev_mean, color = irrigation_type, fill = irrigation_type)\n) +\n  geom_line(aes(group = tratamento), linewidth = 1) +\n  geom_point(shape = 21, size = 2, color = \"black\") +\n  geom_errorbar(\n    aes(ymin = sev_mean - sev_sd, ymax = sev_mean + sev_sd),\n    width = 0.2, alpha = 0.8\n  ) +\n  theme_bw() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    axis.title = element_text(family = \"roboto\", size = 12),\n    axis.text = element_text(family = \"roboto\", size = 11),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Alta Umidade — Dia: {frame_along}\",\n    x = \"Tempo (dias)\",\n    y = \"Severidade da doença (%)\",\n    color = \"Tipo de irrigação\",\n    fill = \"Tipo de irrigação\"\n  ) +\n  scale_color_manual(values = cores_irrigation) +\n  scale_fill_manual(values = cores_irrigation) +\n  transition_reveal(along = time)\n\n#Criar animação\n#gif_anim_high <- animate(gif_high, fps = 10, width = 800, height = 500, renderer = #gifski_renderer())\n\n# Salvar\n#anim_save(\"severidade_high_moisture.gif\", gif_anim_high)\n```\n\n![](severidade_high_moisture.gif)\n\n###### Observações:\n\nNeste estudo, foram avaliados cinco tipos de irrigação sob dois níveis de umidade do solo: High (alta) e Moderate (moderada). No entanto, o experimento não segue um delineamento fatorial completo, ou seja, nem todos os tipos de irrigação possuem dados para ambos os níveis de umidade.\n\nMais especificamente:\n\n-   O sistema de irrigação Drip possui dados apenas sob condição de alta umidade (High), não havendo registros para umidade moderada;\n\n-   Por outro lado, o sistema Furrow está representado apenas sob umidade moderada (Moderate), sem dados disponíveis para alta umidade.\n\nDevido a essas lacunas no delineamento, optamos por remover as combinações incompletas. Como consequência, os tratamentos \"Drip\" (alta umidade) e \"Furrow\" (umidade moderada) foram excluídos da análise, uma vez que não permitem a comparação entre os dois níveis de umidade. Essa decisão teve como objetivo garantir uma análise da interação entre os métodos de irrigação sob diferentes condições de umidade.\n\n```{r}\n# Identificar quais irrigation_type têm os dois níveis de moisture\ntipos_validos <- dados %>%\n  group_by(irrigation_type) %>%\n  summarise(n_moisture = n_distinct(moisture)) %>%\n  filter(n_moisture == 2) %>%\n  pull(irrigation_type)\n\n# Filtrar os dados para manter apenas os tipos válidos\ndados_filtrados <- dados %>%\n  filter(irrigation_type %in% tipos_validos)\n```\n\n#### Boxplot de severidade final\n\n```{r}\ndados_63 <- dados_filtrados |> \n  dplyr::filter(time == 63)\n\naov_dados63 = aov(sev ~ irrigation_type*moisture + as.factor(block), data = dados_63)\nsummary(aov_dados63)\n```\n\n```{r}\n\nggplot(dados_63, aes(x = irrigation_type, y = sev, fill = irrigation_type, color = irrigation_type)) +\n  geom_boxplot(alpha = 0.8, size = 0.8, show.legend = FALSE) +\n  labs(\n    title = \"Severidade por Tipo de Irrigação e Umidade\",\n    x = NULL,  # >>> remove o título do eixo X\n    y = \"Severidade\",\n    fill = \"Tipo de Irrigação\",  # >>> legenda mais limpa\n    color = \"Tipo de Irrigação\"\n  ) +\n  geom_jitter(shape = 1, size = 1) +\n  scale_fill_manual(values = cores_irrigation) +  # >>> novas cores por tipo\n  scale_color_manual(values = cores_contorno) +      # >>> novos contornos por tipo\n  facet_wrap(~moisture) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_blank(),  # >>> inclinação para visualização melhor\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),  # >>> aumento da fonte para melhor leitura\n    legend.position = \"bottom\"\n  ) +\nguides(\n  fill = guide_legend(override.aes = list(shape = 21, size = 5))\n)\n```\n\n## Análise estatística e teste de hipóteses\n\n-   **Hipótese nula (H₀):** A severidade da doença é igual para todos os tratamentos estudados;\n\n-   **Hipótese alternativa (Hₐ):** Pelo menos um dos tratamentos apresenta severidade média diferente da dos demais.\n\n### ANOVA\n\nPara a realização da ANOVA, foi considerado apenas o último tempo de avaliação da severidade da doença (aos 63 dias de avaliação), uma vez que o objetivo principal era identificar quais tratamentos apresentaram menor severidade e, portanto, foram mais eficazes no controle da doença. A análise foi conduzida para avaliar os efeitos do tipo de irrigação (*irrigation_type*), do nível de umidade do solo (*moisture*) e de sua interação (*irrigation_type × moisture*). O bloco experimental (*block*) foi incluído como fator aleatório, convertido com `as.factor(block)`.\n\nA análise do modelo de ANOVA foi realizada utilizando a função `aov`, a qual faz parte do pacote base do R. Os resultados da ANOVA foram obtidos com s`ummary(aov_dados63)`, permitindo a identificação de efeitos significativos entre os tratamentos.\n\n| Efeito | df | F value | Pr(\\>F) | Significância |\n|----|----|----|----|----|\n| `irrigation_type` | 2 | 462.898 | 1.39e-10 | \\*\\*\\* significativo ao nível de 0% |\n| `moisture` | 1 | 13.342 | 0.00444 | \\*\\* significativo ao nível de 0,1% |\n| `block` (como fator) | 2 | 0.221 | 0.80572 | NS |\n| `irrigation_type:moisture` | 2 | 3.661 | 0.06413 | . significativo ao nível de 5% |\n| `residual` | 10 | — | — | — |\n\nA hipótese nula (H₀) foi rejeitada, uma vez que os valores de *p* para os fatores principais foram menores que ao nível de significância de 0,05. Assim, aceita-se a hipótese alternativa (Hₐ), indicando que pelo menos um dos tratamentos difere significativamente dos demais.\n\n-   Efeito principal de tipo de irrigação (*irrigation_type*):\\\n    Muito significativo (p \\< 0,001), indicando que os diferentes métodos de irrigação afetaram de forma clara e consistente a severidade da doença;\n\n-   Efeito principal de umidade (*moisture*):\\\n    Significativo (p = 0,00444), sugerindo que o nível de umidade do solo (alta vs. moderada) também teve impacto importante na severidade da doença, independentemente do tipo de irrigação;\n\n-   Efeito do bloco (*block*):\\\n    Não significativo (p = 0,80572), indicando que a variação entre blocos foi mínima, o que pode ser interpretado como consistência entre repetições;\n\n-   Interação entre irrigação e umidade (*irrigation_type:moisture*): Marginalmente significativa (p = 0,06413), a interação entre os fatores sugere que o efeito da umidade pode depender do tipo de irrigação. Embora não tenha atingido significância estatística ao nível de 5%, o valor de p indica uma tendência de interação que poderia se tornar significativa com um maior número de repetições ou uma amostra mais robusta, reduzindo a variabilidade e aumentando o poder do teste.\n\n#### Checagem das premissas\n\n##### Histograma\n\nPara verificar a normalidade dos resíduos do modelo de ANOVA, foi construído um histograma dos resíduos utilizando a função `hist()`. O comando `residuals(aov_dados63)` extrai os resíduos do modelo.\n\n```{r}\n# Histogram\nhist(residuals(aov_dados63),\n     main = \"Histograma dos resíduos da ANOVA (SEV)\",\n     xlab = \"Resíduos\",\n     ylab = \"Frequência\",\n     col = \"lightgreen\",\n     border = \"black\")\n```\n\n###### Interpretação\n\nForma aproximadamente simétrica: a distribuição dos resíduos é centrada em torno de zero, o que é um indicativo positivo de normalidade. Os resíduos estão distribuídos em um intervalo relativamente estreito (aproximadamente entre -0,025 e 0,02), sugerindo ausência de valores extremos (*outliers*). A maior frequência de resíduos ocorre próxima de zero, o que é característico de distribuições normais.\n\n##### DHARMa\n\nPara avaliar as suposições do modelo linear ajustado, foi utilizada a simulação de resíduos por meio do pacote `DHARMa`.\n\nPrimeiramente, foi ajustado um modelo linear aos dados. Em seguida, os resíduos foram simulados com a função `simulateResiduals()` do pacote `DHARMa`, que gera resíduos padronizados baseados em simulações sob o modelo ajustado. Essa abordagem é especialmente útil para detectar desvios de normalidade, heterocedasticidade e efeitos de estrutura nos dados.\n\n###### Painel esquerdo - QQ-plot dos resíduos simulados:\n\nEsse gráfico demonstra a normalidade dos resíduos de forma robusta.\n\nOs triângulos seguem bem a linha vermelha de 45°, o que é um bom sinal.\n\n**KS test:** p = 0.69937, maior que p \\> 0.05. Não há evidência de que os resíduos violam a normalidade.\n\n**Dispersion test:** p = 0.24. Não há problema de superdispersão.\n\n**Outlier test:** p = 1. Nenhum outlier significativo detectado.\n\nOs resíduos estão aproximadamente normais e sem outliers problemáticos. Pressuposto de normalidade atendido.\n\n###### **Painel Direito - Resíduos simulados vs valores preditos**\n\nO que o gráfico indica:\n\nRed curves = significância estatística: a presença de curvas vermelhas indica que houve desvio significativo dos quantis esperados.\n\nO texto vermelho confirma: Isso não é um problema grave, mas sugere que:\n\nPode haver algum padrão residual leve, talvez relacionado a variâncias diferentes entre grupos (heterocedasticidade leve).\n\nIsso não invalida o modelo, mas é um sinal para cautela na interpretação dos efeitos.\n\nPor isso, foi realizado o leveneTest() para confirmar se há heterocedasticidade.\n\nDepois foram  utilizados testes mais específicos para verificar a normalidade:\n\n```{r}\nmodelo_lm <- lm(sev ~ irrigation_type * moisture + as.factor(block), data = dados_63)\n\n# 4. Simular resíduos com DHARMa\nresiduos_sim <- simulateResiduals(fittedModel = modelo_lm)\n\n# 5. Plotar diagnósticos\nplot(residuos_sim)\n```\n\n###### Normalidade\n\nPrimeiramente, utilizou-se a função `check_normality()` para obter uma verificação geral da normalidade dos resíduos.\n\nEm seguida, foi construído um gráfico QQ-plot (Quantile-Quantile). Esse gráfico compara a distribuição dos resíduos observados com a distribuição normal teórica. Uma boa aderência dos pontos à linha vermelha indica que os resíduos seguem aproximadamente uma distribuição normal, o que foi observado no gráfico, sem desvios acentuados.\n\nPor fim, foi aplicado o teste de *Shapiro-Wilk* `shapiro.test()`. Esse teste estatístico avalia formalmente a hipótese nula de que os resíduos seguem uma distribuição normal. Um valor de *p* ≥ que 0,05 indica que não há evidências para rejeitar a normalidade dos resíduos, confirmando que essa suposição foi atendida no modelo.\n\n```{r}\ncheck_normality(aov_dados63)\n\n# QQ-plot\nqqnorm(residuals(aov_dados63), main = \"QQ-Plot dos resíduos\") \nqqline(residuals(aov_dados63), col = \"red\", lwd = 2)\n\n# Teste de Shapiro-Wilk\nshapiro.test(residuals(aov_dados63))\n```\n\n###### Homocedasticidade\n\nTeste geral com check_heteroscedasticity().\n\n#### **Testes estatísticos:**\n\n**Bartlett’s test (**`bartlett.test`**):** É indicado apenas quando os resíduos seguem uma distribuição normal. \n\nUm valor de *p* \\> 0,05 indica que não há evidência significativa de heterogeneidade de variâncias, ou seja, a suposição de homocedasticidade é atendida.**\\\n**\n\n**Levene’s test (**`leveneTest`**):** Este teste é mais robusto quando a normalidade não pode ser totalmente garantida.\\\nUm *p* \\> 0,05 sugere homogeneidade de variâncias entre os grupos. Se o valor for menor que 0,05, isso indicaria heterocedasticidade, violando uma das suposições da ANOVA.\n\n```{r}\ncheck_heteroscedasticity(aov_dados63)\n\n#Bartlett (apenas se resíduos forem normais):\nbartlett.test(sev ~ interaction(irrigation_type, moisture), data = dados_63)\n\n#Para dados não necessariamente normais\nleveneTest(sev ~ interaction(irrigation_type, moisture), data = dados_63)\n\n```\n\n### Teste de comparação de médias\n\n```{r}\n# Médias ajustadas\nmedias <- emmeans(modelo_lm, ~ irrigation_type * moisture)\n\n# Comparações de médias com agrupamento por letras\nletras <- cld(medias, adjust = \"sidak\", Letters = letters)\n\n# Visualizar resultado\nprint(letras)\n```\n\nA tabela abaixo apresenta as médias ajustadas da severidade da doença para cada combinação de tipo de irrigação e umidade, incluindo erro padrão, intervalos de confiança, e o agrupamento por letras. O agrupamento foi feito com base na comparação múltipla utilizando o método de Sidak ajustado para Tukey (α = 0,05). Letras iguais indicam ausência de diferença estatística significativa.\n\n|  |  |  |  |  |  |  |  |\n|----|----|----|----|----|----|----|----|\n| Tipo de Irrigação | Umidade | Média Ajustada | SE | GL | IC Inferior | IC Superior | Grupo |\n| Overhead | Alta | 0.124 | 0.00898 | 10 | 0.0944 | 0.153 | a |\n| Overhead | Moderada | 0.129 | 0.00898 | 10 | 0.1 | 0.159 | a |\n| MS above canopy | Alta | 0.147 | 0.00898 | 10 | 0.1174 | 0.176 | a |\n| MS above canopy | Moderada | 0.168 | 0.00898 | 10 | 0.1387 | 0.197 | a |\n| MS | Alta | 0.35 | 0.00898 | 10 | 0.321 | 0.38 | b |\n| MS | Moderada | 0.404 | 0.00898 | 10 | 0.3744 | 0.433 | c |\n\n```{r}\nemmeans(modelo_lm, pairwise ~ moisture, adjust = \"tukey\")\ncld(emmeans(modelo_lm, ~ moisture), adjust = \"tukey\")\n\n```\n\nA tabela abaixo apresenta as médias ajustadas da severidade da doença para cada nível de umidade, com erro padrão, intervalos de confiança e agrupamento por letras. O agrupamento foi realizado utilizando o método de Sidak (α = 0,05), ajustado a partir de comparações múltiplas.\n\n|          |                |         |     |             |             |       |\n|----------|----------------|---------|-----|-------------|-------------|-------|\n| Umidade  | Média Ajustada | SE      | GL  | IC Inferior | IC Superior | Grupo |\n| Alta     | 0.207          | 0.00518 | 10  | 0.193       | 0.221       | 1     |\n| Moderada | 0.234          | 0.00518 | 10  | 0.22        | 0.247       | 2     |\n\n## AUDPC\n\nPara quantificar o avanço da doença ao longo do tempo, foi realizada a análise da Área Abaixo da Curva de Progresso da Doença (*AACPD* ou *AUDPC*), utilizando todos os tempos de avaliação disponíveis no experimento. Essa métrica resume, em um único valor, a intensidade acumulada da doença durante o período observado, sendo amplamente utilizada em estudos epidemiológicos por refletir tanto a severidade quanto a duração da infecção.\n\nA análise foi conduzida com o pacote `epifitter` (fornece funções para análise do cálculo da AACPD), especificamente por meio da função `audpc()`. A função `audpc()` calcula a Área Abaixo da Curva de Progresso da Doença com base: na severidade da doença *(sev)* multiplicada por 100 (para expressar em %), e no tempo de avaliação *(time)*. O resultado é armazenado em *aacpd_resultado*, que contém uma linha para cada combinação de tratamento e bloco, com o valor correspondente da AACPD.\n\n```{r}\nlibrary(epifitter)\nlibrary(dplyr)\n\n# 3. Calcular a AACPD para cada combinação de tratamento e bloco\naacpd_resultado <- dados2 %>%\n  group_by(tratamento, block) %>%\n  summarise(AACPD = audpc(sev*100, time), .groups = \"drop\")\n\n# 4. Visualizar os resultados\nprint(aacpd_resultado)\n\n```\n\n### ANOVA\n\n```{r}\nmodelo_aacpd <- aov(AACPD ~ tratamento, data = aacpd_resultado)\nsummary(modelo_aacpd)\n```\n\n#### Checagem das premissas\n\n##### Histograma\n\nO gráfico mostrou uma distribuição aproximadamente simétrica e centrada em torno de zero, o que indica que os resíduos seguem uma tendência próxima à distribuição normal.\n\n```{r}\n# Histogram\nhist(residuals(modelo_aacpd),\n     main = \"Histograma dos resíduos da ANOVA (AACPD)\",\n     xlab = \"Resíduos\",\n     ylab = \"Frequência\",\n     col = \"lightgreen\",\n     border = \"black\")\n```\n\n##### DHARMa (AACPD)\n\nOs resultados indicaram que o modelo se comporta adequadamente, sem violações evidentes dos pressupostos estatísticos. Entretanto o resultado apresentado pelo teste de resíduos simulados *vs* valores preditos exige com o que seja necessário fazer testes adicionais.\n\n```{r}\nmodelo_lmaacpd <- lm(AACPD ~ tratamento + as.factor(block), data = aacpd_resultado)\n\n# 4. Simular resíduos com DHARMa\nresiduos_simaacpd <- simulateResiduals(fittedModel = modelo_lmaacpd)\n\n# 5. Plotar diagnósticos\nplot(residuos_simaacpd)\n```\n\n###### Normalidade (AACPD)\n\nA normalidade dos resíduos do modelo de ANOVA para a variável *AACPD* foi avaliada por meio do gráfico QQ-Plot e do teste de Shapiro-Wilk. O gráfico indicou boa aderência dos resíduos à linha de normalidade. Já o teste de Shapiro-Wilk apresentou valor de *p* = 0,3125, indicando que não há evidência significativa de violação da normalidade (*p* \\> 0,05). Portanto, o modelo atende ao pressuposto de normalidade dos resíduos, sendo apropriado para a análise.\n\n```{r}\ncheck_normality(modelo_aacpd)\n\n# QQ-plot\nqqnorm(residuals(modelo_aacpd), main = \"QQ-Plot dos resíduos\")\nqqline(residuals(modelo_aacpd), col = \"red\", lwd = 2)\n\n# Teste de Shapiro-Wilk\nshapiro.test(residuals(modelo_aacpd))\n```\n\n###### Homocedasticidade (AACPD)\n\nEsses dados confirmam a homocedasticidade dos dados, confirmando portanto a última premissa da ANOVA.\n\n```{r}\ncheck_heteroscedasticity(modelo_aacpd)\n\n#Bartlett (apenas se resíduos forem normais):\nbartlett.test(AACPD ~ tratamento, data = aacpd_resultado)\n\n#Para dados não necessariamente normais\nleveneTest(AACPD ~ tratamento, data = aacpd_resultado)\n\n```\n\n### Boxplot (AACPD)\n\n```{r}\naacpd_resultado2 <- aacpd_resultado %>%\n  mutate(\n    irrigation_type = case_when(\n      str_detect(tratamento, \"Drip\") ~ \"Drip\",\n      str_detect(tratamento, \"Furrow\") ~ \"Furrow\",\n      str_detect(tratamento, \"MS above canopy\") ~ \"MS above canopy\",\n      str_detect(tratamento, \"MS\") ~ \"MS\",\n      str_detect(tratamento, \"Overhead\") ~ \"Overhead\"\n    )\n  )\n\naacpd_resultado2 <- aacpd_resultado2 %>%\n  mutate(\n    irrigation_type = case_when(\n      str_detect(tratamento, \"Drip\") ~ \"Drip\",\n      str_detect(tratamento, \"Furrow\") ~ \"Furrow\",\n      str_detect(tratamento, \"MS above canopy\") ~ \"MS above canopy\",\n      str_detect(tratamento, \"MS\") ~ \"MS\",\n      str_detect(tratamento, \"Overhead\") ~ \"Overhead\"\n    ),\n    moisture = case_when(\n      str_detect(tratamento, \"High moisture\") ~ \"High moisture\",\n      str_detect(tratamento, \"Moderate moisture\") ~ \"Moderate moisture\",\n      str_detect(tratamento, \"Low moisture\") ~ \"Low moisture\"\n    )\n  )\n\n\nggplot(aacpd_resultado2, aes(x = tratamento, y = AACPD, fill = irrigation_type, color = irrigation_type)) +\n  geom_boxplot(alpha = 0.8, size = 0.8, show.legend = FALSE) +\n  labs(\n    title = \"Área Abaixo da Curva do Progresso da Doença (AACPD)\",\n    x = NULL,\n    y = \"AACPD\",\n    fill = \"Tipo de Irrigação\",\n    color = \"Tipo de Irrigação\"\n  ) +\n  geom_jitter(shape = 1, size = 1) +\n  scale_fill_manual(values = cores_irrigation) +\n  scale_color_manual(values = cores_contorno) +\n  facet_wrap(~moisture) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(family = \"poppins\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.title.position = \"plot\",\n    axis.title = element_text(family = \"roboto\", size = 12, face = \"plain\"),\n    axis.text.x = element_blank(),\n    axis.text.y = element_text(family = \"roboto\", size = 12),\n    legend.title = element_text(family = \"roboto\", size = 13),\n    legend.text = element_text(family = \"roboto\", size = 10),\n    legend.position = \"bottom\"\n  ) +\n  guides(\n    fill = guide_legend(override.aes = list(shape = 21, size = 5))\n  )\n```\n\n### Teste de comparação de médias (AACPD)\n\n```{r}\n# ANOVA já ajustada no objeto modelo_aacpd\n# Teste de comparação de médias (Tukey)\n# Converter bloco para fator, se necessário\naacpd_resultado$block <- as.factor(aacpd_resultado$block)\n\n# Rodar ANOVA novamente com bloco (modelo mais completo)\nmodelo_com_bloco <- aov(AACPD ~ tratamento + block, data = aacpd_resultado)\n\n# Teste de Tukey com agricolae\ntukey_resultado <- HSD.test(modelo_com_bloco, trt = \"tratamento\", group = TRUE)\n\n# Visualizar grupos\nprint(tukey_resultado$groups)\n\n```\n\nA tabela abaixo apresenta as médias de AACPD e o agrupamento por letras. O agrupamento foi feito com base na comparação múltipla utilizando o método de TukeyHSD ajustado para Tukey (α = 0,05). Letras iguais indicam ausência de diferença estatística significativa.\n\n| Tratamento                              | Média AACPD | Grupo |\n|-----------------------------------------|-------------|-------|\n| **Furrow + Moderate moisture**          | 1379.93     | a     |\n| **Drip + High moisture**                | 1338.98     | a     |\n| **MS + Moderate moisture**              | 1118.37     | b     |\n| **MS + High moisture**                  | 852.02      | c     |\n| **MS above canopy + Moderate moisture** | 485.57      | d     |\n| **MS above canopy + High moisture**     | 399.23      | de    |\n| **Overhead + Moderate moisture**        | 381.27      | e     |\n| **Overhead + High moisture**            | 368.43      | e     |\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"highlight-style":"github","output-file":"analise.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":"minty","page-layout":"full","code-copy":true,"title":"Análise de dados do PowderyMildew:"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}